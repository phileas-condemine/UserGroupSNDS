1                                         Le Système SAS         16:51 Thursday, December 21, 2017

NOTE: Copyright (c) 2002-2010 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.3 (TS1M1) 
      Licensed to UGAP POUR LE MINISTERE DE LA SANTE, Site 50100370.
NOTE: This session is executing on the W32_7PRO  platform.



NOTE: Updated analytical products:

SAS/STAT 9.3_M1, SAS/ETS 9.3_M1

NOTE: L'initialisation de SAS used:
      real time           1.13 secondes
      cpu time            0.21 secondes
      
1          PROC SQL;
2          	CREATE TABLE Rec_MG1602 AS
3          	SELECT
4          		t1.ben_nai_ann,
5          		(2016-input(t1.ben_nai_ann,4.)) as AGE,
6          		t1.ben_nir_psa, t1.ben_rng_gem,
7          		(t1.ben_nir_psa||put(t1.ben_rng_gem,1.)) as ben_nir_uni,
8          		t1.ben_sex_cod, t1.ben_dcd_ame,
9          		t1.ben_res_dpt, t1.ben_res_com ,
10         		t1.org_aff_ben,
11         		t1.FLX_DIS_DTD, t1.PRS_NAT_REF,
12         		t1.BSE_REM_BSE, t1.EXE_SOI_AMD,
13         		sum(t1.PRS_ACT_QTE) as nb_consult  /* Par NIR pseudonymisé, somme des consultations
13       ! remontées dans le mois */
14         	FROM oravue.ER_PRS_F t1
15          	WHERE (t1.CPL_MAJ_TOP<2) /* Enlève les lignes liées à des majorations */
16         		AND substr(t1.exe_soi_amd,1,4)="2016" /* Année de soin : 2016 */
17         		AND  t1.flx_dis_dtd = '1Feb2016:0:0:0'dt /* Mois de remontée de données : février
17       ! 2016 */
18         		AND substr(t1.BEN_DCD_AME,1,4) ne "2016" /* Personnes encore en vie en 2017 */
19         		/******* INDICATEUR SOUHAITE ********/
20         		/* (Ici : Consultation chez le généraliste) */
21         		AND t1.PRS_NAT_REF in (1111,1112,1211,1212)AND (t1.PSE_SPE_COD in (1,22,23) or
21       ! (t1.PSE_SPE_COD = 99))
22         		/***/
23         	GROUP BY t1.ben_nir_psa, t1.ben_rng_gem ;
ERROR: Nom ORAVUE non attribué.
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
24         QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.25 secondes
      cpu time            0.01 secondes
      
25         


26         data Rec_MG1602;
27         set Rec_MG1602;
ERROR: Le fichier WORK.REC_MG1602.DATA n'existe pas.
28         if substr(org_aff_ben,4,2)='97' then dpt_org=substr(org_aff_ben,4,3);
29         else dpt_org=substr(org_aff_ben,4,2);
30         regime=substr(org_aff_ben,1,3);
31         annee=substr(exe_soi_amd,1,4) ;
32         mois=substr(exe_soi_amd,5,2);
33         if (ben_res_com in ('000','999') or ben_res_dpt in ('000','099','991','999')) then
33       ! depcom='     ';/*Commune ou département inconnu*/
34         else if ben_res_dpt ne '209' and substr(ben_res_dpt,1,2) ne '97' then
34       ! depcom=compress(substr(ben_res_dpt,2,2)||ben_res_com);/*Cas général*/
35         else if ben_res_dpt = '209' then depcom=compress(substr(ben_res_dpt,1,2)||ben_res_com);
35       ! /*Corse*/
36         else if (grg_aff_cod = '02A' and substr(ben_res_dpt,1,2)='97') then
36       ! depcom=compress(ben_res_dpt||substr(ben_res_com,2,2));/*DOM pour MSA*/
37         else if ((grg_aff_cod in ('03A','04A','05A')) and substr(ben_res_dpt,1,2)='97') then
37       ! depcom=compress(ben_res_dpt||substr(ben_res_com,2,2));/*DOM pour MSA*/
2                                         Le Système SAS         16:51 Thursday, December 21, 2017

38         if ben_res_dpt>='001' and ben_res_dpt<='095' then dpt_f=ben_res_dpt;
39         	else if ben_res_dpt='209' then dpt_f='020';		
40         else if substr(depcom,1,2)='97' then dpt_f=substr(depcom,1,3);
41         /* Cas où la commune n'est pas disponible mais le département est disponible */
42         	else if substr(ben_res_dpt,1,2)='97' and depcom not in ('97123','97127') and
42       ! depcom<'97700' then dpt_f=substr(ben_res_dpt,1,3);/*département de résidence si MSA ou
42       ! RSI*/
43         	/* Cas où ni la commune ni le département ne sont disponibles mais le département de
43       ! l'organisme est retrouvé (tous sauf RSI)*/
44         else if grg_aff_cod in ('01M','01C','02A') and dpt_org<='95' and dpt_org ne '975'  then
44       !  dpt_f=compress('0'||dpt_org);/*département de la caisse d'affiliation sinon (hors
44       ! RSI)*/
45         else if grg_aff_cod in ('01M','01C','02A') and dpt_org<='976' and dpt_org ne '975' and
45       ! depcom not in ('97123','97127') and depcom<'97700' then dpt_f=dpt_org;/*département de
45       ! la caisse d'affiliation sinon (hors RSI)*/
46         	else if ben_res_dpt='097' and depcom not in ('97123','97127') and depcom<'97700' then
46       ! dpt_f='097';
47         run;

NOTE: Numeric values have been converted to character values at the places given by: 
      (Line):(Column).
      28:11   28:53   29:21   30:15   31:14   32:13   
NOTE: The SAS System stopped processing this step because of errors.
NOTE: SAS set option OBS=0 and will continue to check statements. 
      This might cause NOTE: No observations in data set.
WARNING: The data set WORK.REC_MG1602 may be incomplete.  When this step was stopped there were 0 
         observations and 11 variables.
NOTE: L'étape DATA used (Total process time):
      real time           0.03 secondes
      cpu time            0.00 secondes
      

48         
49         PROC SQL;
50            CREATE TABLE WORK.REC_MG16 AS
51            SELECT DISTINCT /* l'option distinct permet de conserver deux lignes
52            					pour les individus dont les informations ont changé*/
53         			t1.AGE,
54                   t1.BEN_NIR_PSA,
55                   t1.ben_nir_uni,
56                   t1.BEN_RES_COM,
57                   t1.BEN_RES_DPT,
58                   t1.BEN_RNG_GEM,
59                   t1.depcom,
60                   t1.dpt_f,
61                   t1.dpt_org,
62                     (MIN(t1.mois)) AS mois1,
63                     (MAX(t1.mois)) AS mois2,
64         			(MAX(input(t1.mois,2.))-MIN(input(t1.mois,2.))) AS duree,
65                     (SUM(t1.nb_consult)) AS Nbtot_consult,
66                   t1.ORG_AFF_BEN
67               FROM sasdata1.REC_MG2016 t1
68               GROUP BY t1.BEN_NIR_PSA,
69                        t1.BEN_RNG_GEM;
ERROR: Nom SASDATA1 non attribué.
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
70         QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      
71         


72         PROC sort data=REC_MG16; by ben_nir_uni DESCENDING duree ; run;
ERROR: Le fichier WORK.REC_MG16.DATA n'existe pas.
ERROR: No data set open to look up variables.
ERROR: No data set open to look up variables.

3                                         Le Système SAS         16:51 Thursday, December 21, 2017

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      


73         data sasdata1.REC_INDMG16; set REC_MG16; by ben_nir_uni; if first.ben_nir_uni;run;
ERROR: Le fichier WORK.REC_MG16.DATA n'existe pas.

ERROR: Nom SASDATA1 non attribué.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: L'étape DATA used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      


74         
75         
76          /* Jointure avec le référentiel de béneficiaires pour repérer les individus doublons
76       ! et récuperer les informations individuelles administratives */
77         data orauser.REC_INDMG16; set sasdata1.REC_INDMG16;run;
ERROR: Nom SASDATA1 non attribué.

ERROR: Nom ORAUSER non attribué.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: L'étape DATA used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      

78         PROC SQL;
79           CREATE TABLE BEN_MG_16 AS
80            SELECT
81         			t1.AGE,
82                   t1.BEN_NIR_PSA, t1.BEN_RNG_GEM,
83                   t1.ben_nir_uni,
84                   t1.BEN_RES_COM as prs_res_com,
85                   t1.BEN_RES_DPT as prs_res_dpt,
86                   t1.depcom, t1.dpt_f, t1.dpt_org,
87                	  t1.mois1, t1.mois2, t1.duree,
88                   t1.Nbtot_consult,
89         		  t1.ORG_AFF_BEN,
90                   t2.BEN_NAI_ANN,
91                   t2.BEN_SEX_COD,
92            		  t2.BEN_DCD_AME,
93         		  t2.BEN_RES_DPT, t2.BEN_RES_COM,
94         		  t2.BEN_IDT_ANO, t2.ben_idt_top,t2.ben_top_cns,
95         		  t2.ben_dte_maj
96               FROM orauser.REC_INDMG16 t1 INNER JOIN oravue.IR_BEN_R t2
97         		ON (t1.BEN_NIR_PSA = t2.BEN_NIR_PSA) AND (t1.BEN_RNG_GEM  = t2.BEN_RNG_GEM)
98               ORDER BY t2.BEN_IDT_ANO;
ERROR: Nom ORAUSER non attribué.
ERROR: Nom ORAVUE non attribué.
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
99          QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      
100        
101         /* Recodage du département à partir du référentiel du bénéficiaire : création de
101      ! depben */


102        data ben_mg_16; set ben_mg_16;
ERROR: Le fichier WORK.BEN_MG_16.DATA n'existe pas.
103         if (ben_res_dpt>='001' and ben_res_dpt<='095') or (substr(ben_res_dpt,1,2)='97') then
4                                         Le Système SAS         16:51 Thursday, December 21, 2017

103      ! depben=ben_res_dpt;/*Cas général*/
104        else if ben_res_dpt = '209'  then depben='020';/*Corse*/
105        else if ben_res_dpt='097' and ben_res_com not in ('000','999') then
105      ! depben=compress(substr(ben_res_dpt,2,2)||substr(ben_res_com,1,1)); /*DOM */
106        else depben="";/*Commune ou département inconnu*/run;

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.BEN_MG_16 may be incomplete.  When this step was stopped there were 0 
         observations and 3 variables.
NOTE: L'étape DATA used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      


107        
108         proc sql;
108      !            create table BEN_MG16UNI AS
109         SELECT *, sum(NBTOT_CONSULT) as NB_consult_ind,
110        CASE WHEN (DEPBEN = DPT_F) THEN 1
111        ELSE WHEN (DEPBEN ne DPT_F) THEN 0 END AS DPT_IND
                                       ____
                                       22
                                       76
ERROR 22-322: Syntax error, expecting one of the following: !, !!, &, *, **, +, -, /, <, <=, <>, 
              =, >, >=, ?, AND, BETWEEN, CONTAINS, END, EQ, EQT, GE, GET, GT, GTT, IN, IS, LE, 
              LET, LIKE, LT, LTT, NE, NET, NOT, NOTIN, OR, ^, ^=, |, ||, ~, ~=.  

ERROR 76-322: Syntax error, statement will be ignored.

112        FROM BEN_MG_16 GROUP by BEN_IDT_ANO ORDER BY ben_idt_ano, dpt_ind, duree desc ;
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
112      !                                                                                QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.02 secondes
      cpu time            0.00 secondes
      
113         /* Conservation d'une ligne par individu : celle associée à deux départements
113      ! identiques pour le soin et le référentiel bénéficiaire d'abord
114        puis si ils sont tous le temps différents, la ligne associée à la durée entre deux
114      ! soins la plus grande*/


115         data ben_mg16uniq; set ben_mg16uni; by ben_idt_ano; if first.ben_idt_ano  ;run;
ERROR: Le fichier WORK.BEN_MG16UNI.DATA n'existe pas.

NOTE: The SAS System stopped processing this step because of errors.
WARNING: The data set WORK.BEN_MG16UNIQ may be incomplete.  When this step was stopped there were 
         0 observations and 0 variables.
NOTE: L'étape DATA used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      

116        
117         /** Création de la variable finale DPT qui mixe le département remonté dans le
117      ! référentiel du bénéficiaire **/
118        /* et celui retrouvé à partir des prestations de soin. La règle de décision peut être
118      ! discutée.*/
119        data sasdata1.ben_mg16uniq; set ben_mg16uniq; if dpt_ind=1 then dpt=depben;
120        else if depben<='095' and depben >='001' then dpt=depben;
121        else if substr(depben,1,2)='97' and depben ne '975' then dpt=depben;
122        else if dpt_f<='095' and dpt_f>='001' then dpt=dpt_f;
123        else if substr(dpt_f,1,2)='97' and dpt_f ne '975' then dpt=dpt_f;
124        else if dpt_f='097' and substr(dpt_org,1,2)='97' then dpt=dpt_org;
125        else if dpt_org ne '' and dpt_org>='01' and dpt_org<='95' then
125      ! dpt=compress('0'||dpt_org); /* a discuter */
126        else if substr(dpt_org,1,2)='20' then dpt="020";
127        else if substr(dpt_org,1,2)='97' then dpt=dpt_org;
5                                         Le Système SAS         16:51 Thursday, December 21, 2017

128        else dpt='';
129        run;

NOTE: Character values have been converted to numeric values at the places given by: 
      (Line):(Column).
      120:17   120:36   121:47   122:48   123:60   125:20   125:36   125:54   125:68   126:43
      128:10   
NOTE: Numeric values have been converted to character values at the places given by: 
      (Line):(Column).
      121:16   124:32   125:82   126:16   127:16   
ERROR: Nom SASDATA1 non attribué.
NOTE: L'étape DATA used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      

130        
131        
132        
133        
134        /*** Comptage par département ***/
135        PROC SQL;
136           CREATE TABLE WORK.consult_par_dpt AS
137           SELECT t1.dpt, count(*) as nb_consultMG
138                     FROM sasdata1.ben_mg16uniq t1
139              WHERE t1.NB_consult_ind>0 GROUP BY t1.dpt ;
ERROR: Nom SASDATA1 non attribué.
NOTE: PROC SQL set option NOEXEC and will continue to check the syntax of statements.
140        QUIT;
NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 secondes
      cpu time            0.00 secondes
      

ERROR: Errors printed on pages 1,2,3,4,5.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: Le Système SAS used:
      real time           1.58 secondes
      cpu time            0.23 secondes
      
